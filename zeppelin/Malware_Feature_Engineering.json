{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597772377801_-57142321","id":"paragraph_1597772377801_-57142321","dateCreated":"2020-08-18T17:39:37+0000","status":"FINISHED","focus":true,"$$hashKey":"object:338","text":"import org.apache.spark.ml.feature._\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, TrainValidationSplit, TrainValidationSplitModel}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.{DataFrame, Row, SparkSession}\nimport org.apache.spark.ml.feature.StringIndexer\n","dateUpdated":"2020-08-18T17:46:57+0000","dateFinished":"2020-08-18T17:46:57+0000","dateStarted":"2020-08-18T17:46:57+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597772817410_-2102802882","id":"paragraph_1597772817410_-2102802882","dateCreated":"2020-08-18T17:46:57+0000","status":"FINISHED","focus":true,"$$hashKey":"object:413","text":"val malware_list_rdd = sc.wholeTextFiles(\"s3a://ml-workflow-data/security/Malware_Dataset/Malware_Classification_DataSet/*.asm\")","dateUpdated":"2020-08-18T17:49:34+0000","dateFinished":"2020-08-18T17:49:35+0000","dateStarted":"2020-08-18T17:49:34+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597772868860_-1393776247","id":"paragraph_1597772868860_-1393776247","dateCreated":"2020-08-18T17:47:48+0000","status":"FINISHED","focus":true,"$$hashKey":"object:618","text":" val malware_df = spark.createDataFrame(malware_list_rdd).toDF(\"file_path\", \"text\")\n        .withColumn(\"file_name\",split(col(\"file_path\"),\"/\")\n        .getItem(6)).withColumn(\"file_name\", regexp_replace($\"file_name\", \".asm\" , \"\") )","dateUpdated":"2020-08-18T17:49:36+0000","dateFinished":"2020-08-18T17:49:38+0000","dateStarted":"2020-08-18T17:49:36+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597772837427_1850837219","id":"paragraph_1597772837427_1850837219","dateCreated":"2020-08-18T17:47:17+0000","status":"FINISHED","focus":true,"$$hashKey":"object:519","text":"malware_df.show(5)","dateUpdated":"2020-08-18T17:50:09+0000","dateFinished":"2020-08-18T17:50:18+0000","dateStarted":"2020-08-18T17:50:09+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597773147802_-481345791","id":"paragraph_1597773147802_-481345791","dateCreated":"2020-08-18T17:52:27+0000","status":"FINISHED","focus":true,"$$hashKey":"object:941","text":"val fileName_df= spark.read.format(\"csv\").option(\"inferSchema\", \"true\")\n      .option(\"header\", \"true\")\n      .load(\"s3a://ml-workflow-data/security/Malware_Dataset/Malware_Classification_DataSet/Training_Label_Classification_SmallSet.csv\")\n","dateUpdated":"2020-08-18T17:55:42+0000","dateFinished":"2020-08-18T17:55:50+0000","dateStarted":"2020-08-18T17:55:42+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597773180613_-1387641499","id":"paragraph_1597773180613_-1387641499","dateCreated":"2020-08-18T17:53:00+0000","status":"FINISHED","focus":true,"$$hashKey":"object:1066","text":"fileName_df.show(5)","dateUpdated":"2020-08-18T17:55:52+0000","dateFinished":"2020-08-18T17:55:52+0000","dateStarted":"2020-08-18T17:55:52+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597773215687_640188420","id":"paragraph_1597773215687_640188420","dateCreated":"2020-08-18T17:53:35+0000","status":"FINISHED","focus":true,"$$hashKey":"object:1176","text":"val raw_df = malware_df.join(fileName_df, Seq(\"file_name\"), \"inner\")\n      .withColumnRenamed(\"Text\",\"RawText\")\n      .repartition(200)\n      .cache()\n      ","dateUpdated":"2020-08-18T18:15:09+0000","dateFinished":"2020-08-18T18:15:10+0000","dateStarted":"2020-08-18T18:15:09+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597773419472_-2002792409","id":"paragraph_1597773419472_-2002792409","dateCreated":"2020-08-18T17:56:59+0000","status":"FINISHED","focus":true,"$$hashKey":"object:1388","text":"raw_df.show(5)","dateUpdated":"2020-08-18T18:15:15+0000","dateFinished":"2020-08-18T18:17:47+0000","dateStarted":"2020-08-18T18:15:15+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597774090680_-483343226","id":"paragraph_1597774090680_-483343226","dateCreated":"2020-08-18T18:08:10+0000","status":"ERROR","focus":true,"$$hashKey":"object:1513","text":"raw_df.write.mode(\"append\").format(\"parquet\").option(\"compression\",\"snappy\").saveAsTable(\"malware_tmp_1\")","dateUpdated":"2020-08-18T18:24:59+0000","dateFinished":"2020-08-18T18:24:59+0000","dateStarted":"2020-08-18T18:24:59+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597774641782_603785221","id":"paragraph_1597774641782_603785221","dateCreated":"2020-08-18T18:17:21+0000","status":"FINISHED","focus":true,"$$hashKey":"object:1781","text":"spark.sql(\"select count(*) from malware_tmp_1\").show(5)","dateUpdated":"2020-08-18T18:23:59+0000","dateFinished":"2020-08-18T18:24:00+0000","dateStarted":"2020-08-18T18:23:59+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597775363431_1354077921","id":"paragraph_1597775363431_1354077921","dateCreated":"2020-08-18T18:29:23+0000","status":"FINISHED","focus":true,"$$hashKey":"object:2332","text":"val temp_df=spark.sql(\"select * from malware_tmp_1\").repartition(200)","dateUpdated":"2020-08-18T18:33:00+0000","dateFinished":"2020-08-18T18:33:00+0000","dateStarted":"2020-08-18T18:33:00+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597775117411_1712419423","id":"paragraph_1597775117411_1712419423","dateCreated":"2020-08-18T18:25:17+0000","status":"FINISHED","focus":true,"$$hashKey":"object:2119","text":"def featureEngineeringCountF(spark: SparkSession,dataMatrix: DataFrame): DataFrame ={\n\n    val tokenizer = new RegexTokenizer().setInputCol(\"RawText\").setOutputCol(\"wordsArray\")\n    val remover = new StopWordsRemover().setInputCol(\"wordsArray\").setOutputCol(\"filteredWords\")\n    val cnt = new  CountVectorizer().setInputCol(\"filteredWords\").setOutputCol(\"countv\").setVocabSize(20)\n    val assembler = new VectorAssembler().setInputCols(Array(\"countv\")).setOutputCol(\"features\")\n    val pipeline = new Pipeline().setStages(Array(tokenizer, remover, cnt, assembler))\n    val model= pipeline.fit(dataMatrix)\n    model.transform(dataMatrix).drop(\"RawText\",\"wordsArray\",\"filteredWords\")\n\n\n  }\n  \n  val final_df = featureEngineeringCountF(spark,temp_df)\n","dateUpdated":"2020-08-18T18:56:37+0000","dateFinished":"2020-08-18T18:36:41+0000","dateStarted":"2020-08-18T18:33:09+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597775830387_518779702","id":"paragraph_1597775830387_518779702","dateCreated":"2020-08-18T18:37:10+0000","status":"FINISHED","focus":true,"$$hashKey":"object:2552","text":"final_df.cache()\nfinal_df.show(10)","dateUpdated":"2020-08-18T18:56:45+0000","dateFinished":"2020-08-18T18:38:18+0000","dateStarted":"2020-08-18T18:37:31+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-192-168-2-158.us-west-2.compute.internal:4041/jobs/job?id=24","$$hashKey":"object:2834"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597775944908_17864639","id":"paragraph_1597775944908_17864639","dateCreated":"2020-08-18T18:39:04+0000","status":"RUNNING","focus":true,"$$hashKey":"object:2683","text":"final_df.write.mode(\"overwrite\").format(\"parquet\").option(\"compression\",\"snappy\").saveAsTable(\"malware_tmp_2\")\n","dateUpdated":"2020-08-18T18:46:35+0000","dateFinished":"2020-08-18T18:45:36+0000","dateStarted":"2020-08-18T18:46:35+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597776761756_-2143982609","id":"paragraph_1597776761756_-2143982609","dateCreated":"2020-08-18T18:52:41+0000","status":"READY","focus":true,"$$hashKey":"object:2843","text":"spark.sql(\"select * from malware_tmp_2\").show()","dateUpdated":"2020-08-18T18:53:11+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597773132262_-15856242","id":"paragraph_1597773132262_-15856242","dateCreated":"2020-08-18T17:52:12+0000","status":"READY","focus":true,"$$hashKey":"object:867"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597773009922_-1088732844","id":"paragraph_1597773009922_-1088732844","dateCreated":"2020-08-18T17:50:09+0000","status":"READY","focus":true,"$$hashKey":"object:757"}],"name":"Malware_FeatureEngineering","id":"2FGN1MGV8","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Malware_FeatureEngineering"}