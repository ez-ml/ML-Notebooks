{"paragraphs":[{"text":"val malware_list_rdd = sc.wholeTextFiles(\"s3a://ml-workflow-data/security/Malware_Dataset/Malware_Classification_DataSet/*.asm\")","user":"anonymous","dateUpdated":"2020-08-14T19:04:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mmalware_list_rdd\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.rdd.RDD[(String, String)]\u001b[0m = s3a://ml-workflow-data/security/Malware_Dataset/Malware_Classification_DataSet/*.asm MapPartitionsRDD[63] at wholeTextFiles at <console>:25\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597401706018_1056714474","id":"paragraph_1597401706018_1056714474","dateCreated":"2020-08-14T10:41:46+0000","dateStarted":"2020-08-14T19:04:20+0000","dateFinished":"2020-08-14T19:04:20+0000","status":"FINISHED","focus":true,"$$hashKey":"object:178"},{"text":"val malware_df = spark.createDataFrame(malware_list_rdd).toDF(\"File_name\", \"Text\")\n                .withColumn(\"FileName\",split(col(\"File_name\"),\"/\").getItem(6))\n                .withColumn(\"FileName\", regexp_replace($\"FileName\", \".asm\" , \"\") )\n                \n","user":"anonymous","dateUpdated":"2020-08-14T19:04:22+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mmalware_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [File_name: string, Text: string ... 1 more field]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597402906434_-965616232","id":"paragraph_1597402906434_-965616232","dateCreated":"2020-08-14T11:01:46+0000","dateStarted":"2020-08-14T19:04:22+0000","dateFinished":"2020-08-14T19:04:22+0000","status":"FINISHED","$$hashKey":"object:179"},{"text":"val fileName_df= spark.read.format(\"csv\")\n                 .option(\"inferSchema\", \"true\")\n                 .option(\"header\", \"true\").load(\"s3a://ml-workflow-data/security/Malware_Dataset/Malware_Classification_DataSet/Training_Label_Classification_SmallSet.csv\")","user":"anonymous","dateUpdated":"2020-08-14T19:04:34+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mfileName_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [FileName: string, Label: int]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597403449252_-1546428326","id":"paragraph_1597403449252_-1546428326","dateCreated":"2020-08-14T11:10:49+0000","dateStarted":"2020-08-14T19:04:34+0000","dateFinished":"2020-08-14T19:04:43+0000","status":"FINISHED","$$hashKey":"object:180"},{"text":"val mergedDf = malware_df.join(fileName_df, Seq(\"FileName\"), \"inner\")\n                .withColumnRenamed(\"File_name\",\"FileLocation\")\n                .withColumnRenamed(\"Text\",\"RawText\")\n","user":"anonymous","dateUpdated":"2020-08-14T19:11:08+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mmergedDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [FileName: string, FileLocation: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597431500846_-420405650","id":"paragraph_1597431500846_-420405650","dateCreated":"2020-08-14T18:58:20+0000","dateStarted":"2020-08-14T19:11:08+0000","dateFinished":"2020-08-14T19:11:08+0000","status":"FINISHED","$$hashKey":"object:181"},{"text":"//spark.sql(\"SET hive.exec.dynamic.partition.mode = nonstrict \")\n//mergedDf.write.mode(\"append\").partitionBy(\"Label\").format(\"hive\").saveAsTable(\"malware_raw\")\n\nmergedDf.write.mode(\"overwrite\").format(\"parquet\").option(\"compression\",\"snappy\").saveAsTable(\"malware_tmp\")\n\n","user":"anonymous","dateUpdated":"2020-08-14T20:07:56+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597433080756_-503289068","id":"paragraph_1597433080756_-503289068","dateCreated":"2020-08-14T19:24:40+0000","dateStarted":"2020-08-14T20:07:56+0000","dateFinished":"2020-08-14T20:12:42+0000","status":"FINISHED","$$hashKey":"object:182"},{"text":"//val df = spark.sql(\"SELECT * FROM malware_tmp\")\ndf.show(3)","user":"anonymous","dateUpdated":"2020-08-15T00:54:05+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+-----+\n|            FileName|        FileLocation|             RawText|Label|\n+--------------------+--------------------+--------------------+-----+\n|01kcPWA9K2BOxQeS5Rju|s3a://ml-workflow...|HEADER:10000000\t\t...|    1|\n|04EjIdbPV5e1XroFOpiN|s3a://ml-workflow...|HEADER:4DF30000\t\t...|    1|\n|05EeG39MTRrI6VY21DPd|s3a://ml-workflow...|HEADER:10000000\t\t...|    1|\n+--------------------+--------------------+--------------------+-----+\nonly showing top 3 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-192-168-2-69.us-west-2.compute.internal:4040/jobs/job?id=2","$$hashKey":"object:1627"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597441782197_2027570298","id":"paragraph_1597441782197_2027570298","dateCreated":"2020-08-14T21:49:42+0000","dateStarted":"2020-08-15T00:54:05+0000","dateFinished":"2020-08-15T01:00:53+0000","status":"FINISHED","$$hashKey":"object:183"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-192-168-2-69.us-west-2.compute.internal:4040/jobs/job?id=5","$$hashKey":"object:1841"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597452814684_-1786064432","id":"paragraph_1597452814684_-1786064432","dateCreated":"2020-08-15T00:53:34+0000","status":"RUNNING","focus":true,"$$hashKey":"object:1511","text":"//Logistic Regression Example\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.classification.LogisticRegression\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nimport org.apache.spark.ml.feature.{HashingTF, StopWordsRemover, IDF, Tokenizer}\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.mllib.linalg.Vector\nimport org.apache.spark.ml.feature.{OneHotEncoder, StringIndexer}\n\nval tokenizer=new Tokenizer().setInputCol(\"RawText\").setOutputCol(\"Words\")\nval stopWordRemover=new StopWordsRemover().setInputCol(\"Words\").setOutputCol(\"Filtered\").setCaseSensitive(false)\n\nval hashingTf=new HashingTF().setNumFeatures(20).setInputCol(\"Filtered\").setOutputCol(\"RawFeatures\")\n\nval pipeline = new Pipeline().setStages(Array(tokenizer, stopWordRemover, hashingTf))\nval model = pipeline.fit(df)\nval df_temp = model.transform(df)\n\nval df_transformed=df_temp.drop(\"RawText\",\"Words\",\"Filtered\",\"FileLocation\")\n\ndf_transformed.write.mode(\"overwrite\").format(\"parquet\").option(\"compression\",\"snappy\").saveAsTable(\"malware_tmp_2\")","dateUpdated":"2020-08-15T01:15:11+0000","dateFinished":"2020-08-15T01:14:12+0000","dateStarted":"2020-08-15T01:15:11+0000"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-192-168-2-69.us-west-2.compute.internal:4040/jobs/job?id=4","$$hashKey":"object:1828"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597453489487_-876589750","id":"paragraph_1597453489487_-876589750","dateCreated":"2020-08-15T01:04:49+0000","status":"FINISHED","focus":true,"$$hashKey":"object:1655","text":"df_transformed.show(5)","dateUpdated":"2020-08-15T01:14:14+0000","dateFinished":"2020-08-15T01:14:27+0000","dateStarted":"2020-08-15T01:14:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+-----+--------------------+\n|            FileName|        FileLocation|Label|         RawFeatures|\n+--------------------+--------------------+-----+--------------------+\n|01kcPWA9K2BOxQeS5Rju|s3a://ml-workflow...|    1|(20,[0,1,2,3,4,5,...|\n|04EjIdbPV5e1XroFOpiN|s3a://ml-workflow...|    1|(20,[0,1,2,3,4,5,...|\n|05EeG39MTRrI6VY21DPd|s3a://ml-workflow...|    1|(20,[0,1,2,3,4,5,...|\n|05rJTUWYAKNegBk2wE8X|s3a://ml-workflow...|    1|(20,[0,1,2,3,4,5,...|\n|0AnoOZDNbPXIr2MRBSCJ|s3a://ml-workflow...|    1|(20,[0,1,2,3,4,5,...|\n+--------------------+--------------------+-----+--------------------+\nonly showing top 5 rows\n\n"}]}},{"text":"predictions.show(10)","user":"anonymous","dateUpdated":"2020-08-15T00:06:17+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:24: \u001b[31merror: \u001b[0mnot found: value predictions\n       predictions.show(10)\n       ^\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597449964903_-147873782","id":"paragraph_1597449964903_-147873782","dateCreated":"2020-08-15T00:06:04+0000","dateStarted":"2020-08-15T00:06:17+0000","dateFinished":"2020-08-15T00:06:38+0000","status":"ERROR","$$hashKey":"object:185"},{"text":"fileName_df.show(5)","user":"anonymous","dateUpdated":"2020-08-14T18:01:52+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|            FileName|Label|\n+--------------------+-----+\n|01kcPWA9K2BOxQeS5Rju|    1|\n|04EjIdbPV5e1XroFOpiN|    1|\n|05EeG39MTRrI6VY21DPd|    1|\n|05rJTUWYAKNegBk2wE8X|    1|\n|0AnoOZDNbPXIr2MRBSCJ|    1|\n+--------------------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597403711847_1568089245","id":"paragraph_1597403711847_1568089245","dateCreated":"2020-08-14T11:15:11+0000","dateStarted":"2020-08-14T18:01:52+0000","dateFinished":"2020-08-14T18:01:52+0000","status":"FINISHED","$$hashKey":"object:186"},{"text":"malware_df.select(\"FileName\").show(5,false)","user":"anonymous","dateUpdated":"2020-08-14T18:57:35+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|FileName            |\n+--------------------+\n|01kcPWA9K2BOxQeS5Rju|\n|04EjIdbPV5e1XroFOpiN|\n|05EeG39MTRrI6VY21DPd|\n|05rJTUWYAKNegBk2wE8X|\n|0AnoOZDNbPXIr2MRBSCJ|\n+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597402927280_-1795645168","id":"paragraph_1597402927280_-1795645168","dateCreated":"2020-08-14T11:02:07+0000","dateStarted":"2020-08-14T18:57:35+0000","dateFinished":"2020-08-14T18:57:36+0000","status":"FINISHED","$$hashKey":"object:187"},{"text":"mergedDf.show(5)","user":"anonymous","dateUpdated":"2020-08-14T19:11:11+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+-----+\n|            FileName|        FileLocation|             RawText|Label|\n+--------------------+--------------------+--------------------+-----+\n|01kcPWA9K2BOxQeS5Rju|s3a://ml-workflow...|HEADER:10000000\t\t...|    1|\n|04EjIdbPV5e1XroFOpiN|s3a://ml-workflow...|HEADER:4DF30000\t\t...|    1|\n|05EeG39MTRrI6VY21DPd|s3a://ml-workflow...|HEADER:10000000\t\t...|    1|\n|05rJTUWYAKNegBk2wE8X|s3a://ml-workflow...|HEADER:7DF00000\t\t...|    1|\n|0AnoOZDNbPXIr2MRBSCJ|s3a://ml-workflow...|HEADER:10000000\t\t...|    1|\n+--------------------+--------------------+--------------------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597431895973_-1994396361","id":"paragraph_1597431895973_-1994396361","dateCreated":"2020-08-14T19:04:55+0000","dateStarted":"2020-08-14T19:11:11+0000","dateFinished":"2020-08-14T19:11:13+0000","status":"FINISHED","$$hashKey":"object:188"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597433072921_-12239350","id":"paragraph_1597433072921_-12239350","dateCreated":"2020-08-14T19:24:32+0000","status":"READY","$$hashKey":"object:189"},{"text":"spark.sql(\"show tables\").show()","user":"anonymous","dateUpdated":"2020-08-15T01:24:58+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597433028883_-1276107930","id":"paragraph_1597433028883_-1276107930","dateCreated":"2020-08-14T19:23:48+0000","dateStarted":"2020-08-15T01:24:58+0000","dateFinished":"2020-08-14T20:36:50+0000","status":"PENDING","$$hashKey":"object:190"},{"user":"anonymous","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597441763120_835542629","id":"paragraph_1597441763120_835542629","dateCreated":"2020-08-14T21:49:23+0000","status":"READY","$$hashKey":"object:191"},{"text":"","user":"anonymous","dateUpdated":"2020-08-14T19:14:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1597402781465_107567473","id":"paragraph_1597402781465_107567473","dateCreated":"2020-08-14T10:59:41+0000","status":"READY","$$hashKey":"object:192"}],"name":"Malware_Analysis_Classification","id":"2FH5WX6XV","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Malware_Analysis_Classification"}