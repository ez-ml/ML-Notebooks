{"paragraphs":[{"text":"spark.sql(\"show tables\").show()","user":"anonymous","dateUpdated":"2020-05-02T18:48:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------------+-----------+\n|database|        tableName|isTemporary|\n+--------+-----------------+-----------+\n| default|  nyc_trips_final|      false|\n| default|nyc_trips_final_1|      false|\n| default| nyc_trips_temp_1|      false|\n| default|             test|      false|\n+--------+-----------------+-----------+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588378217158_-2135500187","id":"paragraph_1588378217158_-2135500187","dateCreated":"2020-05-02T00:10:17+0000","dateStarted":"2020-05-02T18:48:06+0000","dateFinished":"2020-05-02T18:48:06+0000","status":"FINISHED","focus":true,"$$hashKey":"object:20824"},{"text":"import spark.implicits._\nimport spark.sql\n\nval nyc_trip_df=sql(\"SELECT * from nyc_trips_final\")\n                .drop(\"store_and_forward\",\"rate_code\",\"mta_tax\",\"tip_amt\",\"tolls_amt\",\"total_amt\") //Drop the columns from dataframe\n                .withColumn(\"hour\",hour(col(\"trip_pickup_datetime\"))) //Add Hour column\n                .withColumn(\"day_of_week\",date_format(col(\"trip_pickup_datetime\"),\"u\")) //Add day_of_week column\n                .withColumn(\"payment_type\", upper(col(\"payment_type\")))\n                .filter(($\"payment_type\" =!= \"NO CHARGE\" && $\"payment_type\" =!= \"DISPUTE\"))\n                .filter(($\"passenger_count\" > 0 && $\"passenger_count\" < 7))\n                .filter(($\"Start_Lat\" >= 40 && $\"Start_Lat\" <= 41))\n                .filter(($\"End_Lat\" >= 40 && $\"End_Lat\" <= 41))\n                .filter(($\"Start_Lon\" >= -75 && $\"Start_Lon\" <= -72))\n                .filter(($\"End_Lon\" >= -75 && $\"End_Lon\" <= -72))\n                .withColumn(\"Lat_Diff\", $\"Start_Lat\" - $\"End_Lat\")\n                .withColumn(\"Lon_Diff\", $\"Start_Lon\" - $\"End_Lon\")\n                .filter($\"Lat_Diff\" =!= 0).filter($\"Lon_Diff\" =!= 0)\n                ","user":"anonymous","dateUpdated":"2020-05-02T17:56:54+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nimport spark.sql\n\u001b[1m\u001b[34mnyc_trip_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [vendor_name: string, trip_pickup_datetime: timestamp ... 16 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588379617385_176613026","id":"paragraph_1588379617385_176613026","dateCreated":"2020-05-02T00:33:37+0000","dateStarted":"2020-05-02T17:56:54+0000","dateFinished":"2020-05-02T17:56:55+0000","status":"FINISHED","$$hashKey":"object:20825"},{"text":"import org.apache.spark.ml.clustering.KMeans\nimport org.apache.spark.ml.evaluation.ClusteringEvaluator\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.linalg.Vectors\n\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\n\nval featureCols=Array(\"start_lat\",\"start_lon\")\nval assembler = new VectorAssembler().setInputCols(Array(\"start_lat\", \"start_lon\")).setOutputCol(\"start_features\")\n\nval kmeans = new KMeans().setK(10).setFeaturesCol(\"start_features\").setPredictionCol(\"start_cluster\")\n\nval pipeline = new Pipeline().setStages(Array(assembler,kmeans))\nval model = pipeline.fit(nyc_trip_df)\nval temp_df = model.transform(nyc_trip_df)\n\n\ntemp_df.show()\n  ","user":"anonymous","dateUpdated":"2020-05-02T18:38:57+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+---------------------+---------------+-------------+----------+---------+----------+---------+------------+--------+---------+----+-----+----+-----------+-------------+------------+--------------------+-------------+\n|vendor_name|trip_pickup_datetime|trip_dropoff_datetime|passenger_count|trip_distance| start_lon|start_lat|   end_lon|  end_lat|payment_type|fare_amt|surcharge|year|month|hour|day_of_week|     Lat_Diff|    Lon_Diff|      start_features|start_cluster|\n+-----------+--------------------+---------------------+---------------+-------------+----------+---------+----------+---------+------------+--------+---------+----+-----+----+-----------+-------------+------------+--------------------+-------------+\n|        CMT| 2009-01-30 23:26:43|  2009-01-30 23:34:28|              1|            1| -73.97747| 40.76373| -73.99628|40.760826|        CASH|     7.4|      0.0|2009|    1|  23|          5| 0.0029029846| 0.018806458|[40.7637290954589...|            4|\n|        CMT| 2009-01-30 19:58:09|  2009-01-30 20:09:11|              2|            2| -73.96281|40.766926| -73.97472| 40.78829|        CASH|     8.6|      0.0|2009|    1|  19|          5| -0.021362305| 0.011909485|[40.7669258117675...|            5|\n|        CMT| 2009-01-31 00:38:45|  2009-01-31 00:45:47|              1|            3| -73.97443|40.793793|  -73.9891|40.771164|        CASH|    10.2|      0.0|2009|    1|   0|          6|  0.022628784| 0.014671326|[40.7937927246093...|            0|\n|        CMT| 2009-01-31 03:29:54|  2009-01-31 03:53:05|              3|            6| -73.98296|40.756477| -73.95058|40.692215|        CASH|    19.4|      0.0|2009|    1|   3|          6|   0.06426239| -0.03238678|[40.7564773559570...|            4|\n|        CMT| 2009-01-30 17:39:34|  2009-01-30 18:06:32|              2|            4| -73.97463|40.742134| -73.98027|40.789864|        CASH|    17.9|      0.0|2009|    1|  17|          5| -0.047729492|0.0056381226|[40.7421340942382...|            5|\n|        CMT| 2009-01-31 02:31:47|  2009-01-31 02:36:19|              1|            1| -73.95999|40.773586| -73.94909| 40.78137|      CREDIT|     5.8|      0.0|2009|    1|   2|          6|-0.0077819824|-0.010902405|[40.7735862731933...|            0|\n|        CMT| 2009-01-25 12:46:28|  2009-01-25 12:53:27|              1|            1| -74.00405| 40.74792|-73.981766|40.759567|        CASH|     6.9|      0.0|2009|    1|  12|          7| -0.011646271|-0.022285461|[40.7479209899902...|            6|\n|        CMT| 2009-01-30 20:17:50|  2009-01-30 20:38:20|              2|            5|-73.960495| 40.76956| -74.00711|40.729496|        CASH|    15.4|      0.0|2009|    1|  20|          5|  0.040065765|   0.0466156|[40.7695617675781...|            0|\n|        CMT| 2009-01-31 03:27:17|  2009-01-31 03:43:00|              1|            6| -73.96866| 40.75483| -73.94274| 40.71482|        CASH|    16.6|      0.0|2009|    1|   3|          6|  0.040008545|-0.025917053|[40.7548294067382...|            5|\n|        DDS| 2009-01-17 00:18:35|  2009-01-17 00:30:48|              1|            2| -73.96498|40.763367| -73.98192| 40.75142|        CASH|     9.3|      0.5|2009|    1|   0|          6|  0.011947632| 0.016937256|[40.7633666992187...|            5|\n|        CMT| 2009-01-26 08:36:11|  2009-01-26 08:43:16|              1|            1|-73.981255| 40.77924|  -73.9831|40.763145|        CASH|     6.1|      0.0|2009|    1|   8|          1|  0.016094208|0.0018463135|[40.7792396545410...|            4|\n|        CMT| 2009-01-30 07:05:53|  2009-01-30 07:17:17|              1|            2| -74.00126| 40.72527|-73.975845|40.755386|        CASH|     9.7|      0.0|2009|    1|   7|          5| -0.030117035|-0.025413513|[40.7252693176269...|            3|\n|        CMT| 2009-01-31 18:29:15|  2009-01-31 18:46:47|              2|            3| -73.95391|40.770725| -73.98758|   40.749|        CASH|    10.9|      0.0|2009|    1|  18|          6|    0.0217247| 0.033668518|[40.7707252502441...|            0|\n|        CMT| 2009-01-26 07:19:07|  2009-01-26 07:22:13|              1|            0| -73.93303|40.763985| -73.94227|40.754326|        CASH|     4.1|      0.0|2009|    1|   7|          1| 0.0096588135| 0.009239197|[40.7639846801757...|            8|\n|        DDS| 2009-01-18 02:55:30|  2009-01-18 02:58:39|              1|            0| -74.00243| 40.74952| -74.00575|40.743652|        CASH|     4.1|      0.5|2009|    1|   2|          7| 0.0058670044|0.0033187866|[40.7495193481445...|            6|\n|        CMT| 2009-01-25 17:41:18|  2009-01-25 17:59:03|              2|            2|  -74.0022|40.718822| -73.98913|40.749588|        CASH|    11.3|      0.0|2009|    1|  17|          7| -0.030765533|-0.013069153|[40.7188224792480...|            3|\n|        CMT| 2009-01-30 15:24:55|  2009-01-30 15:41:45|              1|            2| -73.99474|40.750435| -73.98009|40.782143|        CASH|    11.3|      0.0|2009|    1|  15|          5| -0.031707764|-0.014656067|[40.7504348754882...|            6|\n|        CMT| 2009-01-30 20:23:33|  2009-01-30 20:42:53|              1|            6|-73.934784|40.801147|-73.986916| 40.75929|        CASH|    18.2|      0.0|2009|    1|  20|          5|  0.041858673| 0.052131653|[40.8011474609375...|            0|\n|        CMT| 2009-01-23 16:10:34|  2009-01-23 16:14:51|              1|            0| -73.97575|40.751373| -73.98572| 40.74907|        CASH|     5.5|      0.0|2009|    1|  16|          5| 0.0023040771| 0.009963989|[40.7513732910156...|            5|\n|        CMT| 2009-01-31 03:55:08|  2009-01-31 03:56:36|              2|            0|-73.991585|40.764904| -73.98625|40.770782|      CREDIT|     3.8|      0.0|2009|    1|   3|          6|-0.0058784485|-0.005332947|[40.7649040222168...|            4|\n+-----------+--------------------+---------------------+---------------+-------------+----------+---------+----------+---------+------------+--------+---------+----+-----+----+-----------+-------------+------------+--------------------+-------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.clustering.KMeans\nimport org.apache.spark.ml.evaluation.ClusteringEvaluator\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\n\u001b[1m\u001b[34mfeatureCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(start_lat, start_lon)\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = vecAssembler_7de6c3351a3a\n\u001b[1m\u001b[34mkmeans\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.clustering.KMeans\u001b[0m = kmeans_256f49a7fbf9\n\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_129c2eb51a50\n\u001b[1m\u001b[34mmodel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m = pipeline_129c2eb51a50\n\u001b[1m\u001b[34mtemp_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [vendor_name: ...\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588395681913_702559081","id":"paragraph_1588395681913_702559081","dateCreated":"2020-05-02T05:01:21+0000","dateStarted":"2020-05-02T18:29:04+0000","dateFinished":"2020-05-02T18:34:49+0000","status":"FINISHED","$$hashKey":"object:20826"},{"text":"temp_df.write.mode(\"overwrite\").saveAsTable(\"default.nyc_trips_final_2\")","user":"anonymous","dateUpdated":"2020-05-02T18:53:09+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.hadoop.security.AccessControlException: Permission denied by sticky bit: user=zeppelin, path=\"/user/hive/warehouse/nyc_trips_final_2\":hadoop:hadoop:drwxr-xr-x, parent=\"/user/hive/warehouse\":hdfs:hadoop:drwxrwxrwt\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.throwStickyBitException(FSPermissionChecker.java:545)\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkStickyBit(FSPermissionChecker.java:521)\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:252)\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)\n\tat org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)\n\tat org.apache.hadoop.hdfs.server.namenode.FSDirDeleteOp.delete(FSDirDeleteOp.java:110)\n\tat org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:3093)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.delete(NameNodeRpcServer.java:1114)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.delete(ClientNamenodeProtocolServerSideTranslatorPB.java:705)\n\tat org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)\n\tat org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)\n\tat org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)\n\tat org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)\n\tat org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)\n\n  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n  at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n  at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n  at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:121)\n  at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:88)\n  at org.apache.hadoop.hdfs.DFSClient.delete(DFSClient.java:1609)\n  at org.apache.hadoop.hdfs.DistributedFileSystem$19.doCall(DistributedFileSystem.java:946)\n  at org.apache.hadoop.hdfs.DistributedFileSystem$19.doCall(DistributedFileSystem.java:943)\n  at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n  at org.apache.hadoop.hdfs.DistributedFileSystem.delete(DistributedFileSystem.java:953)\n  at org.apache.spark.internal.io.FileCommitProtocol.deleteWithJob(FileCommitProtocol.scala:124)\n  at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.deleteMatchingPartitions(InsertIntoHadoopFsRelationCommand.scala:241)\n  at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:124)\n  at org.apache.spark.sql.execution.datasources.DataSource.writeAndRead(DataSource.scala:503)\n  at org.apache.spark.sql.execution.command.CreateDataSourceTableAsSelectCommand.saveDataIntoTable(createDataSourceTables.scala:217)\n  at org.apache.spark.sql.execution.command.CreateDataSourceTableAsSelectCommand.run(createDataSourceTables.scala:177)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n  at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n  at org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:131)\n  at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:156)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:83)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:83)\n  at org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:676)\n  at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:84)\n  at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:165)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:74)\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:676)\n  at org.apache.spark.sql.DataFrameWriter.createTable(DataFrameWriter.scala:474)\n  at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:449)\n  at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:409)\n  ... 109 elided\nCaused by: org.apache.hadoop.ipc.RemoteException: Permission denied by sticky bit: user=zeppelin, path=\"/user/hive/warehouse/nyc_trips_final_2\":hadoop:hadoop:drwxr-xr-x, parent=\"/user/hive/warehouse\":hdfs:hadoop:drwxrwxrwt\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.throwStickyBitException(FSPermissionChecker.java:545)\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkStickyBit(FSPermissionChecker.java:521)\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:252)\n\tat org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)\n\tat org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)\n\tat org.apache.hadoop.hdfs.server.namenode.FSDirDeleteOp.delete(FSDirDeleteOp.java:110)\n\tat org.apache.hadoop.hdfs.server.namenode.FSNamesystem.delete(FSNamesystem.java:3093)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.delete(NameNodeRpcServer.java:1114)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.delete(ClientNamenodeProtocolServerSideTranslatorPB.java:705)\n\tat org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)\n\tat org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)\n\tat org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)\n\tat org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)\n\tat org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)\n\n  at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1545)\n  at org.apache.hadoop.ipc.Client.call(Client.java:1491)\n  at org.apache.hadoop.ipc.Client.call(Client.java:1388)\n  at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n  at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:118)\n  at com.sun.proxy.$Proxy11.delete(Unknown Source)\n  at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.delete(ClientNamenodeProtocolTranslatorPB.java:641)\n  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n  at java.lang.reflect.Method.invoke(Method.java:498)\n  at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)\n  at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)\n  at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)\n  at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)\n  at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)\n  at com.sun.proxy.$Proxy12.delete(Unknown Source)\n  at org.apache.hadoop.hdfs.DFSClient.delete(DFSClient.java:1607)\n  ... 137 more\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588445072360_-619888122","id":"paragraph_1588445072360_-619888122","dateCreated":"2020-05-02T18:44:32+0000","dateStarted":"2020-05-02T18:53:09+0000","dateFinished":"2020-05-02T18:53:14+0000","status":"ERROR","$$hashKey":"object:20827"},{"text":"\n","user":"anonymous","dateUpdated":"2020-05-02T18:24:33+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mkmeans\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.clustering.KMeans\u001b[0m = kmeans_eeb584e19fab\n\u001b[1m\u001b[34mmodel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.clustering.KMeansModel\u001b[0m = kmeans_eeb584e19fab\n\u001b[1m\u001b[34mtemp_df_2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [vendor_name: string, trip_pickup_datetime: timestamp ... 18 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588443298770_494737477","id":"paragraph_1588443298770_494737477","dateCreated":"2020-05-02T18:14:58+0000","dateStarted":"2020-05-02T18:16:33+0000","dateFinished":"2020-05-02T18:24:07+0000","status":"FINISHED","$$hashKey":"object:20828"},{"text":"temp_df_2.show(5)","user":"anonymous","dateUpdated":"2020-05-02T18:24:15+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+---------------------+---------------+-------------+---------+---------+---------+---------+------------+--------+---------+----+-----+----+-----------+------------+------------+--------------------+-------------+\n|vendor_name|trip_pickup_datetime|trip_dropoff_datetime|passenger_count|trip_distance|start_lon|start_lat|  end_lon|  end_lat|payment_type|fare_amt|surcharge|year|month|hour|day_of_week|    Lat_Diff|    Lon_Diff|      start_features|start_cluster|\n+-----------+--------------------+---------------------+---------------+-------------+---------+---------+---------+---------+------------+--------+---------+----+-----+----+-----------+------------+------------+--------------------+-------------+\n|        CMT| 2009-01-30 23:26:43|  2009-01-30 23:34:28|              1|            1|-73.97747| 40.76373|-73.99628|40.760826|        CASH|     7.4|      0.0|2009|    1|  23|          5|0.0029029846| 0.018806458|[40.7637290954589...|            4|\n|        CMT| 2009-01-30 19:58:09|  2009-01-30 20:09:11|              2|            2|-73.96281|40.766926|-73.97472| 40.78829|        CASH|     8.6|      0.0|2009|    1|  19|          5|-0.021362305| 0.011909485|[40.7669258117675...|            5|\n|        CMT| 2009-01-31 00:38:45|  2009-01-31 00:45:47|              1|            3|-73.97443|40.793793| -73.9891|40.771164|        CASH|    10.2|      0.0|2009|    1|   0|          6| 0.022628784| 0.014671326|[40.7937927246093...|            0|\n|        CMT| 2009-01-31 03:29:54|  2009-01-31 03:53:05|              3|            6|-73.98296|40.756477|-73.95058|40.692215|        CASH|    19.4|      0.0|2009|    1|   3|          6|  0.06426239| -0.03238678|[40.7564773559570...|            4|\n|        CMT| 2009-01-30 17:39:34|  2009-01-30 18:06:32|              2|            4|-73.97463|40.742134|-73.98027|40.789864|        CASH|    17.9|      0.0|2009|    1|  17|          5|-0.047729492|0.0056381226|[40.7421340942382...|            5|\n+-----------+--------------------+---------------------+---------------+-------------+---------+---------+---------+---------+------------+--------+---------+----+-----+----+-----------+------------+------------+--------------------+-------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588382094548_-940457676","id":"paragraph_1588382094548_-940457676","dateCreated":"2020-05-02T01:14:54+0000","dateStarted":"2020-05-02T18:24:15+0000","dateFinished":"2020-05-02T18:24:16+0000","status":"FINISHED","$$hashKey":"object:20829"},{"text":"nyc_trip_df.count()","user":"anonymous","dateUpdated":"2020-05-02T17:57:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres41\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 652530179\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588378717368_-790955391","id":"paragraph_1588378717368_-790955391","dateCreated":"2020-05-02T00:18:37+0000","dateStarted":"2020-05-02T17:57:53+0000","dateFinished":"2020-05-02T17:58:14+0000","status":"FINISHED","$$hashKey":"object:20830"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1588442273825_1762280744","id":"paragraph_1588442273825_1762280744","dateCreated":"2020-05-02T17:57:53+0000","status":"READY","$$hashKey":"object:20831"}],"name":"NYC_Taxi_Fare_Predictions","id":"2FA5GRJTC","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/NYC_Taxi_Fare_Predictions"}